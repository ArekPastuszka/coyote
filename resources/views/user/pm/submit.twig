{% extends 'layout.twig' %}
{% block title %}Wiadomości prywatne {{ parent() }}{% endblock %}

{% import 'components/forms.twig' as forms %}

{% block container %}
    {{ include('user/_top', {active: 'home'}) }}

    <div class="row">
        {% include 'user/_home-menu' %}

        <main class="col-md-10">
            <section class="panel panel-wrapper">
                <div class="panel-body">
                    <h2>Wiadomości prywatne</h2>

                    <ul class="nav nav-panel">
                        <li role="presentation"><a href="{{ route('user.pm') }}">Wiadomości ({{ user('pm_unread') }}/{{ user('pm') }})</a></li>
                        <li role="presentation" class="active"><a href="{{ route('user.pm.submit') }}">Napisz wiadomość</a></li>
                    </ul>

                    <div id="box-pm" class="panel panel-default">
                        <div class="panel-body">
                            {{ form_open({'url': route('user.pm.submit'), 'method': 'POST', 'class': 'form-horizontal'}) }}

                            <div class="form-group">
                                <div class="col-md-12 {{ errors.has('author') > 0 ? 'has-error' }}">
                                    {{ form_text('author', input_old('author'), {'class': 'form-control', 'placeholder': 'Nadawca...'}) }}

                                    {% if errors.first('author') %}
                                        <span class="help-block">{{ errors.first('author') }}</span>
                                    {% endif %}
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="col-md-12 {{ errors.has('text') > 0 ? 'has-error' }}">
                                    <textarea name="text" class="form-control" rows="10">{{ input_old('text') }}</textarea>

                                    {% if errors.first('text') %}
                                        <span class="help-block">{{ errors.first('text') }}</span>
                                    {% endif %}
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="col-md-12">
                                    <button type="submit" class="btn btn-primary btn-sm">
                                        Wyślij
                                    </button>
                                </div>
                            </div>
                            {{ form_close() }}

                        </div>
                    </div>
                </div>
            </section>
        </main>
    </div>
{% endblock %}

{% block head %}
    {{ parent() }}

    <link rel="stylesheet" href="/css/user.css">
{% endblock %}

{% block body %}
    {{ parent() }}

    <script type="text/javascript" src="/js/autogrow.js"></script>
    <script type="text/javascript" src="/js/fast-submit.js"></script>
    <script type="text/javascript" src="/js/prompt.js"></script>
    <script type="text/javascript">
        $(function () {
            $('textarea[name="text"]').prompt('{{ route('user.prompt') }}').fastSubmit().autogrow().focus();
        });
    </script>
{% endblock %}