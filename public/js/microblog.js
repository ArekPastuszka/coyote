"use strict";!function(t){function e(e,o,i){var a="rgb"+(t.support.rgba?"a":"")+"("+parseInt(e[0]+i*(o[0]-e[0]),10)+","+parseInt(e[1]+i*(o[1]-e[1]),10)+","+parseInt(e[2]+i*(o[2]-e[2]),10);return t.support.rgba&&(a+=","+(e&&o?parseFloat(e[3]+i*(o[3]-e[3])):1)),a+")"}function o(t){var e;return(e=/#([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})/.exec(t))?[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16),1]:(e=/#([0-9a-fA-F])([0-9a-fA-F])([0-9a-fA-F])/.exec(t))?[17*parseInt(e[1],16),17*parseInt(e[2],16),17*parseInt(e[3],16),1]:(e=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(t))?[parseInt(e[1]),parseInt(e[2]),parseInt(e[3]),1]:(e=/rgba\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9\.]*)\s*\)/.exec(t))?[parseInt(e[1],10),parseInt(e[2],10),parseInt(e[3],10),parseFloat(e[4])]:a[t]}t.extend(!0,t,{support:{rgba:function(){var e=t("script:first"),o=e.css("color"),i=!1;if(/^rgba/.test(o))i=!0;else try{i=o!=e.css("color","rgba(0, 0, 0, 0.5)").css("color"),e.css("color",o)}catch(a){}return i}()}});var i="color backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor outlineColor".split(" ");t.each(i,function(i,a){t.Tween.propHooks[a]={get:function(e){return t(e.elem).css(a)},set:function(i){var n=i.elem.style,s=o(t(i.elem).css(a)),r=o(i.end);i.run=function(t){n[a]=e(s,r,t)}}}}),t.Tween.propHooks.borderColor={set:function(a){var n=a.elem.style,s=[],r=i.slice(2,6);t.each(r,function(e,i){s[i]=o(t(a.elem).css(i))});var l=o(a.end);a.run=function(o){t.each(r,function(t,i){n[i]=e(s[i],l,o)})}}};var a={aqua:[0,255,255,1],azure:[240,255,255,1],beige:[245,245,220,1],black:[0,0,0,1],blue:[0,0,255,1],brown:[165,42,42,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgrey:[169,169,169,1],darkgreen:[0,100,0,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkviolet:[148,0,211,1],fuchsia:[255,0,255,1],gold:[255,215,0,1],green:[0,128,0,1],indigo:[75,0,130,1],khaki:[240,230,140,1],lightblue:[173,216,230,1],lightcyan:[224,255,255,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],magenta:[255,0,255,1],maroon:[128,0,0,1],navy:[0,0,128,1],olive:[128,128,0,1],orange:[255,165,0,1],pink:[255,192,203,1],purple:[128,0,128,1],violet:[128,0,128,1],red:[255,0,0,1],silver:[192,192,192,1],white:[255,255,255,1],yellow:[255,255,0,1],transparent:[255,255,255,0]}}(jQuery),function(){var t,e;t=jQuery,e=function(e,o){var i,a,n,s=this;return this.options=t.extend({title:null,footer:null,remote:null},t.fn.ekkoLightbox.defaults,o||{}),this.$element=t(e),i="",this.modal_id=this.options.modal_id?this.options.modal_id:"ekkoLightbox-"+Math.floor(1e3*Math.random()+1),n='<div class="modal-header"'+(this.options.title||this.options.always_show_close?"":' style="display:none"')+'><button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button><h4 class="modal-title">'+(this.options.title||"&nbsp;")+"</h4></div>",a='<div class="modal-footer"'+(this.options.footer?"":' style="display:none"')+">"+this.options.footer+"</div>",t(document.body).append('<div id="'+this.modal_id+'" class="ekko-lightbox modal fade" tabindex="-1"><div class="modal-dialog"><div class="modal-content">'+n+'<div class="modal-body"><div class="ekko-lightbox-container"><div></div></div></div>'+a+"</div></div></div>"),this.modal=t("#"+this.modal_id),this.modal_dialog=this.modal.find(".modal-dialog").first(),this.modal_content=this.modal.find(".modal-content").first(),this.modal_body=this.modal.find(".modal-body").first(),this.lightbox_container=this.modal_body.find(".ekko-lightbox-container").first(),this.lightbox_body=this.lightbox_container.find("> div:first-child").first(),this.showLoading(),this.modal_arrows=null,this.border={top:parseFloat(this.modal_dialog.css("border-top-width"))+parseFloat(this.modal_content.css("border-top-width"))+parseFloat(this.modal_body.css("border-top-width")),right:parseFloat(this.modal_dialog.css("border-right-width"))+parseFloat(this.modal_content.css("border-right-width"))+parseFloat(this.modal_body.css("border-right-width")),bottom:parseFloat(this.modal_dialog.css("border-bottom-width"))+parseFloat(this.modal_content.css("border-bottom-width"))+parseFloat(this.modal_body.css("border-bottom-width")),left:parseFloat(this.modal_dialog.css("border-left-width"))+parseFloat(this.modal_content.css("border-left-width"))+parseFloat(this.modal_body.css("border-left-width"))},this.padding={top:parseFloat(this.modal_dialog.css("padding-top"))+parseFloat(this.modal_content.css("padding-top"))+parseFloat(this.modal_body.css("padding-top")),right:parseFloat(this.modal_dialog.css("padding-right"))+parseFloat(this.modal_content.css("padding-right"))+parseFloat(this.modal_body.css("padding-right")),bottom:parseFloat(this.modal_dialog.css("padding-bottom"))+parseFloat(this.modal_content.css("padding-bottom"))+parseFloat(this.modal_body.css("padding-bottom")),left:parseFloat(this.modal_dialog.css("padding-left"))+parseFloat(this.modal_content.css("padding-left"))+parseFloat(this.modal_body.css("padding-left"))},this.modal.on("show.bs.modal",this.options.onShow.bind(this)).on("shown.bs.modal",function(){return s.modal_shown(),s.options.onShown.call(s)}).on("hide.bs.modal",this.options.onHide.bind(this)).on("hidden.bs.modal",function(){return s.gallery&&t(document).off("keydown.ekkoLightbox"),s.modal.remove(),s.options.onHidden.call(s)}).modal("show",o),this.modal},e.prototype={modal_shown:function(){var e,o=this;return this.options.remote?(this.gallery=this.$element.data("gallery"),this.gallery&&("document.body"===this.options.gallery_parent_selector||""===this.options.gallery_parent_selector?this.gallery_items=t(document.body).find('*[data-toggle="lightbox"][data-gallery="'+this.gallery+'"]'):this.gallery_items=this.$element.parents(this.options.gallery_parent_selector).first().find('*[data-toggle="lightbox"][data-gallery="'+this.gallery+'"]'),this.gallery_index=this.gallery_items.index(this.$element),t(document).on("keydown.ekkoLightbox",this.navigate.bind(this)),this.options.directional_arrows&&this.gallery_items.length>1&&(this.lightbox_container.append('<div class="ekko-lightbox-nav-overlay"><a href="#" class="'+this.strip_stops(this.options.left_arrow_class)+'"></a><a href="#" class="'+this.strip_stops(this.options.right_arrow_class)+'"></a></div>'),this.modal_arrows=this.lightbox_container.find("div.ekko-lightbox-nav-overlay").first(),this.lightbox_container.find("a"+this.strip_spaces(this.options.left_arrow_class)).on("click",function(t){return t.preventDefault(),o.navigate_left()}),this.lightbox_container.find("a"+this.strip_spaces(this.options.right_arrow_class)).on("click",function(t){return t.preventDefault(),o.navigate_right()}))),this.options.type?"image"===this.options.type?this.preloadImage(this.options.remote,!0):"youtube"===this.options.type&&(e=this.getYoutubeId(this.options.remote))?this.showYoutubeVideo(e):"vimeo"===this.options.type?this.showVimeoVideo(this.options.remote):"instagram"===this.options.type?this.showInstagramVideo(this.options.remote):"url"===this.options.type?this.loadRemoteContent(this.options.remote):"video"===this.options.type?this.showVideoIframe(this.options.remote):this.error('Could not detect remote target type. Force the type using data-type="image|youtube|vimeo|instagram|url|video"'):this.detectRemoteType(this.options.remote)):this.error("No remote target given")},strip_stops:function(t){return t.replace(/\./g,"")},strip_spaces:function(t){return t.replace(/\s/g,"")},isImage:function(t){return t.match(/(^data:image\/.*,)|(\.(jp(e|g|eg)|gif|png|bmp|webp|svg)((\?|#).*)?$)/i)},isSwf:function(t){return t.match(/\.(swf)((\?|#).*)?$/i)},getYoutubeId:function(t){var e;return e=t.match(/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=)([^#\&\?]*).*/),e&&11===e[2].length?e[2]:!1},getVimeoId:function(t){return t.indexOf("vimeo")>0?t:!1},getInstagramId:function(t){return t.indexOf("instagram")>0?t:!1},navigate:function(t){if(t=t||window.event,39===t.keyCode||37===t.keyCode){if(39===t.keyCode)return this.navigate_right();if(37===t.keyCode)return this.navigate_left()}},navigateTo:function(e){var o,i;return 0>e||e>this.gallery_items.length-1?this:(this.showLoading(),this.gallery_index=e,this.$element=t(this.gallery_items.get(this.gallery_index)),this.updateTitleAndFooter(),i=this.$element.attr("data-remote")||this.$element.attr("href"),this.detectRemoteType(i,this.$element.attr("data-type")||!1),this.gallery_index+1<this.gallery_items.length&&(o=t(this.gallery_items.get(this.gallery_index+1),!1),i=o.attr("data-remote")||o.attr("href"),"image"===o.attr("data-type")||this.isImage(i))?this.preloadImage(i,!1):void 0)},navigate_left:function(){return 1!==this.gallery_items.length?(0===this.gallery_index?this.gallery_index=this.gallery_items.length-1:this.gallery_index--,this.options.onNavigate.call(this,"left",this.gallery_index),this.navigateTo(this.gallery_index)):void 0},navigate_right:function(){return 1!==this.gallery_items.length?(this.gallery_index===this.gallery_items.length-1?this.gallery_index=0:this.gallery_index++,this.options.onNavigate.call(this,"right",this.gallery_index),this.navigateTo(this.gallery_index)):void 0},detectRemoteType:function(t,e){var o;return e=e||!1,"image"===e||this.isImage(t)?(this.options.type="image",this.preloadImage(t,!0)):"youtube"===e||(o=this.getYoutubeId(t))?(this.options.type="youtube",this.showYoutubeVideo(o)):"vimeo"===e||(o=this.getVimeoId(t))?(this.options.type="vimeo",this.showVimeoVideo(o)):"instagram"===e||(o=this.getInstagramId(t))?(this.options.type="instagram",this.showInstagramVideo(o)):"video"===e?(this.options.type="video",this.showVideoIframe(o)):(this.options.type="url",this.loadRemoteContent(t))},updateTitleAndFooter:function(){var t,e,o,i;return o=this.modal_content.find(".modal-header"),e=this.modal_content.find(".modal-footer"),i=this.$element.data("title")||"",t=this.$element.data("footer")||"",i||this.options.always_show_close?o.css("display","").find(".modal-title").html(i||"&nbsp;"):o.css("display","none"),t?e.css("display","").html(t):e.css("display","none"),this},showLoading:function(){return this.lightbox_body.html('<div class="modal-loading">'+this.options.loadingMessage+"</div>"),this},showYoutubeVideo:function(t){var e,o;return o=this.checkDimensions(this.$element.data("width")||560),e=o/(560/315),this.showVideoIframe("//www.youtube.com/embed/"+t+"?badge=0&autoplay=1&html5=1",o,e)},showVimeoVideo:function(t){var e,o;return o=this.checkDimensions(this.$element.data("width")||560),e=o/(500/281),this.showVideoIframe(t+"?autoplay=1",o,e)},showInstagramVideo:function(t){var e,o;return o=this.checkDimensions(this.$element.data("width")||612),this.resize(o),e=o+80,this.lightbox_body.html('<iframe width="'+o+'" height="'+e+'" src="'+this.addTrailingSlash(t)+'embed/" frameborder="0" allowfullscreen></iframe>'),this.options.onContentLoaded.call(this),this.modal_arrows?this.modal_arrows.css("display","none"):void 0},showVideoIframe:function(t,e,o){return o=o||e,this.resize(e),this.lightbox_body.html('<div class="embed-responsive embed-responsive-16by9"><iframe width="'+e+'" height="'+o+'" src="'+t+'" frameborder="0" allowfullscreen class="embed-responsive-item"></iframe></div>'),this.options.onContentLoaded.call(this),this.modal_arrows&&this.modal_arrows.css("display","none"),this},loadRemoteContent:function(e){var o,i,a=this;return i=this.$element.data("width")||560,this.resize(i),o=this.$element.data("disableExternalCheck")||!1,o||this.isExternal(e)?(this.lightbox_body.html('<iframe width="'+i+'" height="'+i+'" src="'+e+'" frameborder="0" allowfullscreen></iframe>'),this.options.onContentLoaded.call(this)):this.lightbox_body.load(e,t.proxy(function(){return a.$element.trigger("loaded.bs.modal")})),this.modal_arrows&&this.modal_arrows.css("display","none"),this},isExternal:function(t){var e;return e=t.match(/^([^:\/?#]+:)?(?:\/\/([^\/?#]*))?([^?#]+)?(\?[^#]*)?(#.*)?/),"string"==typeof e[1]&&e[1].length>0&&e[1].toLowerCase()!==location.protocol?!0:"string"==typeof e[2]&&e[2].length>0&&e[2].replace(new RegExp(":("+{"http:":80,"https:":443}[location.protocol]+")?$"),"")!==location.host?!0:!1},error:function(t){return this.lightbox_body.html(t),this},preloadImage:function(e,o){var i,a=this;return i=new Image,(null==o||o===!0)&&(i.onload=function(){var e;return e=t("<img />"),e.attr("src",i.src),e.addClass("img-responsive"),a.lightbox_body.html(e),a.modal_arrows&&a.modal_arrows.css("display","block"),e.load(function(){return a.resize(i.width),a.options.onContentLoaded.call(a)})},i.onerror=function(){return a.error("Failed to load image: "+e)}),i.src=e,i},resize:function(e){var o;return o=e+this.border.left+this.padding.left+this.padding.right+this.border.right,this.modal_dialog.css("width","auto").css("max-width",o),this.lightbox_container.find("a").css("line-height",function(){return t(this).parent().height()+"px"}),this},checkDimensions:function(t){var e,o;return o=t+this.border.left+this.padding.left+this.padding.right+this.border.right,e=document.body.clientWidth,o>e&&(t=this.modal_body.width()),t},close:function(){return this.modal.modal("hide")},addTrailingSlash:function(t){return"/"!==t.substr(-1)&&(t+="/"),t}},t.fn.ekkoLightbox=function(o){return this.each(function(){var i;return i=t(this),o=t.extend({remote:i.attr("data-remote")||i.attr("href"),gallery_parent_selector:i.attr("data-parent"),type:i.attr("data-type")},o,i.data()),new e(this,o),this})},t.fn.ekkoLightbox.defaults={gallery_parent_selector:"document.body",left_arrow_class:".glyphicon .glyphicon-chevron-left",right_arrow_class:".glyphicon .glyphicon-chevron-right",directional_arrows:!0,type:null,always_show_close:!0,loadingMessage:"Loading...",onShow:function(){},onShown:function(){},onHide:function(){},onHidden:function(){},onNavigate:function(){},onContentLoaded:function(){}}}.call(this),$(function(){function t(t,e){var o=$(t).clone().html();for(var i in e)o=o.replace("[["+i+"]]",e[i]);return o}function e(e){var i=function(){$(this).parent().parent().remove()};return $("textarea",e).prompt(promptUrl).fastSubmit().autogrow().focus(),e.on("click",".btn-flush",i).submit(function(){var t=e.serialize();return $(":input",e).attr("disabled","disabled"),$.post(e.attr("action"),t,function(t){$(t).hide().insertAfter("nav.text-center").fadeIn(900),$("textarea",e).val("").trigger("keydown"),$(".thumbnails",e).html("")}).always(function(){$(":input",e).removeAttr("disabled")}),!1}).on("click",".btn-cancel",function(){var t=parseInt($(this).data("id"));return $("#entry-"+t).find(".microblog-text").html(a[t]),delete a[t],!1}).delegate("#btn-upload","click",function(){$(".input-file",e).click()}).delegate(".input-file","change",function(){var a=this.files[0];if("image/png"!==a.type&&"image/jpg"!==a.type&&"image/gif"!==a.type&&"image/jpeg"!==a.type)$("#alert").modal("show"),$(".modal-body").text("Format pliku jest nieprawidłowy. Załącznik musi być zdjęciem JPG, PNG lub GIF");else{var n=new FormData(e[0]);$.ajax({url:uploadUrl,type:"POST",data:n,cache:!1,contentType:!1,processData:!1,beforeSend:function(){$(".thumbnails",e).append(t("#tmpl-thumbnail",{src:o,"class":"spinner",fa:"fa fa-spinner fa-spin fa-2x"}))},success:function(t){var o=$(".thumbnail:last",e);$(".spinner",o).remove(),$("img",o).attr("src",t.url),$("<div>",{"class":"btn-flush"}).html('<i class="fa fa-remove fa-2x"></i>').click(i).appendTo(o),$('<input type="hidden" name="thumbnail[]" value="'+t.name+'">').appendTo(o)},error:function(t){$("#alert").modal("show"),"undefined"!=typeof t.responseJSON&&$(".modal-body").text(t.responseJSON.photo[0]),$(".thumbnail:last",e).remove()}},"json")}}),e}var o="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfQAAADIAQMAAAAk14GrAAAABlBMVEXd3d3///+uIkqAAAAAI0lEQVRoge3BMQEAAADCoPVPbQ0PoAAAAAAAAAAAAAAAAHg2MgAAAYXziG4AAAAASUVORK5CYII=";$(document).ajaxError(function(t,e){$("#alert").modal("show");var o;o="undefined"!=typeof e.responseJSON.error?e.responseJSON.error:e.responseJSON.text,$(".modal-body").text(o)});var i,a={},n={},s={click:function(){var t=parseInt($(this).data("count")),e=$(this);return e.addClass("loader").text("Proszę czekać..."),$.post(e.attr("href"),function(o){t=parseInt(o.count),e.data("count",t),e.hasClass("thumbs-on")||e.next(".btn-subscribe").click(),e.toggleClass("thumbs-on")}).complete(function(){e.removeClass("loader"),e.text(t+" "+declination(t,["głos","głosy","głosów"]))}),!1},enter:function(){var t=parseInt($(this).data("count"));if(t>0){var e=$(this);"undefined"==typeof e.attr("title")&&(i=setTimeout(function(){$.get(e.attr("href"),function(t){if(e.attr("title",t),t.length){var o=t.split("\n").length;e.attr("title",t.replace(/\n/g,"<br />")).data("count",o).text(o+" "+declination(o,["głos","głosy","głosów"])).tooltip({html:!0}).tooltip("show")}})},500))}$(this).off("mouseenter")},leave:function(){clearTimeout(i)}};if($("#microblog").on("click",".btn-reply",function(){$(this).parent().next(".microblog-comments").find("input").focus()}).on("click",".btn-subscribe",function(){var t=$(this);return $.post(t.attr("href"),function(){t.toggleClass("subscribe-on")}),!1}).on("click",".btn-thumbs, .btn-sm-thumbs",s.click).on("mouseenter",".btn-thumbs, .btn-sm-thumbs",s.enter).on("mouseleave",".btn-thumbs, .btn-sm-thumbs",s.leave).on("click",".btn-edit",function(t){var o=$(this),i=$("#entry-"+o.data("id")).find(".microblog-text");"undefined"==typeof a[o.data("id")]?$.get(o.attr("href"),function(t){a[o.data("id")]=i.html(),i.html(t);var n=e($(".microblog-submit",i));n.unbind("submit").submit(function(){var t=n.serialize();return $(":input",n).attr("disabled","disabled"),$.post(n.attr("action"),t,function(t){i.html(t),delete a[o.data("id")]}).always(function(){$(":input",n).removeAttr("disabled")}),!1})}):(i.html(a[o.data("id")]),delete a[o.data("id")]),t.preventDefault()}).on("click",".btn-remove",function(){var t=$(this);return $("#confirm").modal("show").one("click",".danger",function(){$.post(t.attr("href"),function(){$("#entry-"+t.data("id")).fadeOut(500)}),$("#confirm").modal("hide")}),!1}).on("focus",".comment-submit input",function(){"undefined"==typeof $(this).data("prompt")&&$(this).prompt(promptUrl).data("prompt","yes")}).on("submit",".comment-submit",function(){var t=$(this),e=$('input[type="text"]',t),o=t.serialize();return e.attr("disabled","disabled"),$.post(t.attr("action"),o,function(o){$(o).hide().insertBefore(t).fadeIn(800),e.val("")}).always(function(){e.removeAttr("disabled")}),!1}).on("click",".btn-sm-edit",function(t){var e=$(this),o=$("#comment-"+e.data("id")).find(".inline-edit"),i=function(){o.html(n[e.data("id")]),delete n[e.data("id")]};"undefined"==typeof n[e.data("id")]?$.get(e.attr("href"),function(t){n[e.data("id")]=o.html(),o.html("");var a=$("<form>"),s=$("<input>",{value:t,"class":"form-control",name:"text",autocomplete:"off"}).keydown(function(t){27===t.keyCode&&i()}).appendTo(a);a.submit(function(){var t=a.serialize();return s.attr("disabled","disabled"),$.post(e.attr("href"),t,function(t){$("#comment-"+e.data("id")).replaceWith(t),delete n[e.data("id")]}).always(function(){s.removeAttr("disabled")}),!1}),a.appendTo(o),s.focus().prompt(promptUrl)}):i(),t.preventDefault()}).on("click",".btn-sm-remove",function(){var t=$(this);return $("#confirm").modal("show").one("click",".danger",function(){$.post(t.attr("href"),function(){$("#comment-"+t.data("id")).fadeOut(500)}),$("#confirm").modal("hide")}),!1}).on("click",".show-all a",function(){var t=$(this);return t.text("Proszę czekać..."),$.get(t.attr("href"),function(e){t.parent().replaceWith(e)}),!1}).on("click",'a[data-toggle="lightbox"]',function(t){t.preventDefault(),$(this).ekkoLightbox()}),e($(".microblog-submit")),"onhashchange"in window){var r=function(){var t=window.location.hash;if("entry"===t.substring(1,6)||"comment"===t.substring(1,8)){var e=$(t),o=e.find(".panel");o.length&&(e=o),e.css("background-color","#FFDCA5"),$("#container-fluid").one("mousemove",function(){e.animate({backgroundColor:"#FFF"},1500)})}};window.onhashchange=r,r()}});
//# sourceMappingURL=microblog.js.map